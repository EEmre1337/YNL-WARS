Object.defineProperty(exports,"__esModule",{value:!0}),exports.setupProjectileSystem=setupProjectileSystem;var _gameState=require("./gameState.js"),_collisionUtils=require("./collisionUtils.js"),_gameConfig=require("./gameConfig.js");function setupProjectileSystem(r){return setInterval(function(){_gameState.projectiles.forEach(function(e,a){if(e.x+=e.vx,e.y+=e.vy,(0,_collisionUtils.checkCollision)(e.x-5,e.y-5,10,10,_gameConfig.walls))_gameState.projectiles.splice(a,1);else for(var t in _gameState.players){var o=_gameState.players[t];if(e.owner!==t&&Math.abs(e.x-o.x)<10&&Math.abs(e.y-o.y)<10){handleProjectileHit(o,e,t,r),_gameState.projectiles.splice(a,1);break}}}),r.emit("state",{players:_gameState.players,projectiles:_gameState.projectiles,walls:_gameConfig.walls,flag:_gameState.flag,score:_gameState.score})},1e3/60)}function handleProjectileHit(e,a,t,o){var r,n,l,s=a.damage||1;"shotgun"===a.class&&(r=Math.sqrt(Math.pow(a.x-a.startX,2)+Math.pow(a.y-a.startY,2)),n=_gameConfig.classes.shotgun.maxDistance,l=_gameConfig.classes.shotgun.minDamage,s=Math.max(l,s*(1-r/n))),0<e.armor?(e.armor-=s,e.armor<0&&(e.health+=e.armor,e.armor=0),console.log("ðŸ›¡ ".concat(e.username," wurde getroffen! RÃ¼stung: ").concat(e.armor,", Leben: ").concat(e.health)),o.emit("chatMessage","ðŸ›¡ ".concat(e.username," wurde getroffen! RÃ¼stung: ").concat(e.armor,", Leben: ").concat(e.health))):(e.health-=s,console.log("ðŸ”¥ ".concat(e.username," wurde getroffen! Leben: ").concat(e.health)),o.emit("chatMessage","ðŸ”¥ ".concat(e.username," wurde getroffen! Leben: ").concat(e.health))),e.health<=0&&handlePlayerDeath(e,a,o)}function handlePlayerDeath(e,a,t){console.log("ðŸ’€ ".concat(e.username," wurde eliminiert!")),t.emit("chatMessage","ðŸ’€ ".concat(e.username," wurde eliminiert!")),e.x="red"===e.team?_gameConfig.redSpawn.x+50:_gameConfig.blueSpawn.x+50,e.y="red"===e.team?_gameConfig.redSpawn.y+50:_gameConfig.blueSpawn.y+50,e.health=2,e.armor=0,e.hasFlag&&(_gameState.flag.x=a.x,_gameState.flag.y=a.y,_gameState.flag.holder=null,e.hasFlag=!1)}
//# sourceMappingURL=projectileSystem.min.js.map
