window.socket=io();var canvas=document.getElementById("gameCanvas"),ctx=canvas.getContext("2d"),teamSelection=document.getElementById("teamSelection"),players={},projectiles=[],walls=[],flag={},score={red:0,blue:0},redSpawn={},blueSpawn={},gameRunning=!1,keys={},chatInput=(document.addEventListener("keydown",function(e){["w","a","s","d"].includes(e.key)&&(keys[e.key]=!0)," "===e.key&&canShoot&&(e=Math.atan2(mouseY-playerY,mouseX-playerX),isNaN(e)?console.error("‚ùå Fehler: `angle` ist NaN! Mausposition k√∂nnte falsch sein."):(console.log("üî´ Schie√üen mit Winkel: ".concat(e)),socket.emit("shoot",{angle:e}),canShoot=!1,setTimeout(function(){return canShoot=!0},500)))}),document.addEventListener("keyup",function(e){["w","a","s","d"].includes(e.key)&&(keys[e.key]=!1)}),document.getElementById("chatInput")),chatMessagesContainer=document.getElementById("chatMessages"),canShoot=(document.getElementById("chatForm").addEventListener("submit",function(e){e.preventDefault();e=chatInput.value.trim();e&&(console.log("üì§ Nachricht senden:",e),socket.emit("chatMessage",e),chatInput.value="")}),socket.on("chatUpdate",function(e){console.log("üì• Chat-Nachrichten empfangen:",e),chatMessagesContainer.innerHTML="",e.forEach(function(e){var t=document.createElement("li");t.textContent=e,chatMessagesContainer.appendChild(t)}),chatMessagesContainer.scrollTop=chatMessagesContainer.scrollHeight}),!0);function chooseTeam(e){var t=document.getElementById("username");t?(t=t.value.trim())?(console.log('üì¢ Sende Team-Wahl: { username: "'.concat(t,'", team: "').concat(e,'" }')),socket.emit("chooseTeam",{username:t,team:e}),document.getElementById("teamSelection").style.display="none",document.getElementById("gameCanvas").style.display="block"):alert("Bitte gib einen Namen ein!"):console.error("Fehler: Username-Feld existiert nicht!")}function gameLoop(){keys.w&&socket.emit("move",{dx:0,dy:-3}),keys.a&&socket.emit("move",{dx:-3,dy:0}),keys.s&&socket.emit("move",{dx:0,dy:3}),keys.d&&socket.emit("move",{dx:3,dy:0}),keys[" "]&&canShoot&&(socket.emit("shoot"),canShoot=!1,setTimeout(function(){return canShoot=!0},1e3)),render(),requestAnimationFrame(gameLoop)}function render(){for(var e in ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillStyle="rgba(255, 0, 0, 0.3)",ctx.fillRect(redSpawn.x-50,redSpawn.y-50,100,100),ctx.fillStyle="rgba(0, 0, 255, 0.3)",ctx.fillRect(blueSpawn.x-50,blueSpawn.y-50,100,100),ctx.fillStyle="grey",walls.forEach(function(e){return ctx.fillRect(e.x,e.y,e.width,e.height)}),players){var t=players[e],n=(ctx.fillStyle="red"===t.team?"red":"blue",ctx.beginPath(),ctx.arc(t.x,t.y,10,0,2*Math.PI),ctx.fill(),t.hasFlag&&(ctx.fillStyle="yellow",ctx.fillRect(t.x-5,t.y-20,10,10)),t.x-10),a=t.y+15;ctx.fillStyle="red";for(var o=0;o<t.health;o++)ctx.fillRect(n+12*o,a,10,10);var c=n+12*t.health;ctx.fillStyle="blue";for(var l=0;l<t.armor;l++)ctx.fillRect(c+12*l,a,10,10);t.username&&(ctx.fillStyle="black",ctx.font="14px Arial",ctx.textAlign="center",ctx.fillText(t.username,t.x,t.y-15))}ctx.fillStyle="black",projectiles.forEach(function(e){ctx.beginPath(),ctx.arc(e.x,e.y,5,0,2*Math.PI),ctx.fill()}),ctx.fillStyle="yellow",flag.holder||ctx.fillRect(flag.x-10,flag.y-10,20,20),ctx.fillStyle="green",medikits.forEach(function(e){e.active&&ctx.fillRect(e.x-5,e.y-5,10,10)}),ctx.fillStyle="brown",armors.forEach(function(e){e.active&&ctx.fillRect(e.x-5,e.y-5,10,10)}),ctx.fillStyle="black",ctx.font="20px Arial",ctx.fillText("Rot: ".concat(score.red," | Blau: ").concat(score.blue),700,20)}socket.on("state",function(e){console.log("üì¢ Spielstatus empfangen:",e),players=e.players,projectiles=e.projectiles,walls=e.walls,flag=e.flag,score=e.score,redSpawn=e.redSpawn,blueSpawn=e.blueSpawn,gameRunning||(gameRunning=!0,gameLoop())}),socket.on("gameOver",function(e){alert("".concat("red"===e?"Rotes Team":"Blaues Team"," hat gewonnen!")),location.reload()});var mouseX=0,mouseY=0,playerX=0,playerY=0,medikits=(canvas.addEventListener("mousemove",function(e){var t=canvas.getBoundingClientRect();mouseX=e.clientX-t.left,mouseY=e.clientY-t.top}),socket.on("state",function(e){socket.id in e.players&&(playerX=e.players[socket.id].x,playerY=e.players[socket.id].y)}),document.addEventListener("click",function(){var e;canShoot&&(e=Math.atan2(mouseY-playerY,mouseX-playerX),socket.emit("shoot",{angle:e}),canShoot=!1,setTimeout(function(){return canShoot=!0},500))}),[]),armors=(socket.on("updateMedikits",function(e){medikits=e}),[]);socket.on("updateArmors",function(e){armors=e});
//# sourceMappingURL=game.min.js.map
